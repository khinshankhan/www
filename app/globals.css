@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --transparent: transparent;
    --black: 0, 0%, 0%;
    --white: 0, 100%, 100%;

    --celestial-50: 240, 40%, 98%;
    --celestial-100: 240, 40%, 96.1%;
    --celestial-200: 240, 31.8%, 91.4%;
    --celestial-300: 240, 26.8%, 83.9%;
    --celestial-400: 240, 20.2%, 65.1%;
    --celestial-500: 240, 16.3%, 46.9%;
    --celestial-600: 240, 19.3%, 34.5%;
    --celestial-700: 240, 25%, 26.7%;
    --celestial-800: 240, 32.6%, 17.5%;
    --celestial-900: 240, 47.4%, 11.2%;
    --celestial-950: 240, 84%, 4.9%;

    --brand-50: var(--celestial-50);
    --brand-100: var(--celestial-100);
    --brand-200: var(--celestial-200);
    --brand-300: var(--celestial-300);
    --brand-400: var(--celestial-400);
    --brand-500: var(--celestial-500);
    --brand-600: var(--celestial-600);
    --brand-700: var(--celestial-700);
    --brand-800: var(--celestial-800);
    --brand-900: var(--celestial-900);
    --brand-950: var(--celestial-950);

    --sky-50: 204, 100%, 97.1%;
    --sky-100: 204, 93.8%, 93.7%;
    --sky-200: 200.6, 94.4%, 86.1%;
    --sky-300: 199.4, 95.5%, 73.9%;
    --sky-400: 198.4, 93.2%, 59.6%;
    --sky-500: 198.6, 88.7%, 48.4%;
    --sky-600: 200.4, 98%, 39.4%;
    --sky-700: 201.3, 96.3%, 32.2%;
    --sky-800: 201, 90%, 27.5%;
    --sky-900: 202, 80.3%, 23.9%;
    --sky-950: 204, 80.2%, 15.9%;

    --emerald-50: 151.8, 81%, 95.9%;
    --emerald-100: 149.3, 80.4%, 90%;
    --emerald-200: 152.4, 76%, 80.4%;
    --emerald-300: 156.2, 71.6%, 66.9%;
    --emerald-400: 158.1, 64.4%, 51.6%;
    --emerald-500: 160.1, 84.1%, 39.4%;
    --emerald-600: 161.4, 93.5%, 30.4%;
    --emerald-700: 162.9, 93.5%, 24.3%;
    --emerald-800: 163.1, 88.1%, 19.8%;
    --emerald-900: 164.2, 85.7%, 16.5%;
    --emerald-950: 165.7, 91.3%, 9%;

    --indigo-50: 225.9, 100%, 96.7%;
    --indigo-100: 226.5, 100%, 93.9%;
    --indigo-200: 228, 96.5%, 88.8%;
    --indigo-300: 229.7, 93.5%, 81.8%;
    --indigo-400: 234.5, 89.5%, 73.9%;
    --indigo-500: 238.7, 83.5%, 66.7%;
    --indigo-600: 243.4, 75.4%, 58.6%;
    --indigo-700: 244.5, 57.9%, 50.6%;
    --indigo-800: 243.7, 54.5%, 41.4%;
    --indigo-900: 242.2, 47.4%, 34.3%;
    --indigo-950: 243.8, 47.1%, 20%;

    --amber-50: 48, 100%, 96.1%;
    --amber-100: 48, 96.5%, 88.8%;
    --amber-200: 48, 96.6%, 76.7%;
    --amber-300: 45.9, 96.7%, 64.5%;
    --amber-400: 43.3, 96.4%, 56.3%;
    --amber-500: 37.7, 92.1%, 50.2%;
    --amber-600: 32.1, 94.6%, 43.7%;
    --amber-700: 26, 90.5%, 37.1%;
    --amber-800: 22.7, 82.5%, 31.4%;
    --amber-900: 21.7, 77.8%, 26.5%;
    --amber-950: 20.9, 91.7%, 14.1%;

    --rose-50: 355.7, 100%, 97.3%;
    --rose-100: 355.6, 100%, 94.7%;
    --rose-200: 352.7, 96.1%, 90%;
    --rose-300: 352.6, 95.7%, 81.8%;
    --rose-400: 351.3, 94.5%, 71.4%;
    --rose-500: 349.7, 89.2%, 60.2%;
    --rose-600: 346.8, 77.2%, 49.8%;
    --rose-700: 345.3, 82.7%, 40.8%;
    --rose-800: 343.4, 79.7%, 34.7%;
    --rose-900: 341.5, 75.5%, 30.4%;
    --rose-950: 343.1, 87.7%, 15.9%;

    --plum1: 301, 20%, 9.4%;
    --plum2: 300, 29.8%, 11.2%;
    --plum3: 298, 34.4%, 15.3%;
    --plum4: 297, 36.8%, 18.3%;
    --plum5: 296, 38.5%, 21.1%;
    --plum6: 295, 40.4%, 24.7%;
    --plum7: 294, 42.7%, 30.6%;
    --plum8: 292, 45.1%, 40%;
    --plum9: 292, 45%, 51%;
    --plum10: 295, 50%, 55.4%;
    --plum11: 300, 60%, 62%;
    --plum12: 296, 74%, 95.7%;

    --knockout: var(--black);
    --nav: var(--brand-200);
    --background: var(--white);
    --foreground: var(--brand-950);

    --card: var(--white);
    --card-foreground: var(--brand-950);

    --popover: var(--white);
    --popover-foreground: var(--brand-950);

    --primary: var(--brand-900);
    --primary-foreground: var(--brand-50);

    --secondary: var(--brand-100);
    --secondary-foreground: var(--brand-900);

    --muted: var(--brand-100);
    --muted-foreground: var(--brand-700);

    --accent: var(--brand-100);
    --accent-foreground: var(--brand-900);

    --border: var(--brand-200);
    --input: var(--brand-200);
    --ring: var(--brand-950);

    --logo: var(--transparent);
    --logo-foreground: var(--foreground);
    --logo-border: var(--transparent);
    --logo-shadow: 0, 0%, 43.5%;

    --link-base: var(--plum7);
    --link-active: var(--plum5);
    --link-on: var(--plum3);

    --info: var(--sky-100);
    --info-foreground: var(--sky-900);
    --info-border: var(--sky-400);

    --success: var(--emerald-100);
    --success-foreground: var(--emerald-900);
    --success-border: var(--emerald-400);

    --critical: var(--indigo-100);
    --critical-foreground: var(--indigo-900);
    --critical-border: var(--indigo-400);

    --warning: var(--amber-100);
    --warning-foreground: var(--amber-900);
    --warning-border: var(--amber-400);

    --danger: var(--rose-100);
    --danger-foreground: var(--rose-900);
    --danger-border: var(--rose-400);

    --sh-class: #1e40af;
    --sh-identifier: #622ebc;
    --sh-sign: #48525f;
    --sh-property: #047857;
    --sh-entity: #6039a7;
    --sh-jsxliterals: hsla(var(--black), 85%);
    --sh-string: #913109;
    --sh-keyword: #025583;
    --sh-comment: #495057;

    --icons-anchor: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath stroke='currentColor' fill='currentColor' d='m22 15-3-4-3 4h1.906c-.436 2.469-2.438 4.471-4.906 4.906V13h2v-2h-2V9.336c1.543-.459 2.714-1.923 2.714-3.621C15.714 3.666 14.048 2 12 2S8.286 3.666 8.286 5.715c0 1.698 1.171 3.162 2.714 3.621V11H9v2h2v6.906C8.531 19.471 6.529 17.469 6.094 15H8l-3-4-3 4h2.073c.511 3.885 3.929 7 7.927 7s7.416-3.115 7.927-7H22zM10.286 5.715C10.286 4.77 11.055 4 12 4s1.714.77 1.714 1.715c0 .951-.801 1.785-1.714 1.785s-1.714-.834-1.714-1.785z'/%3E%3C/svg%3E");
  }

  .dark {
    --plum1: 292, 90%, 99.4%;
    --plum2: 300, 100%, 98.6%;
    --plum3: 299, 71.2%, 96.4%;
    --plum4: 299, 62%, 93.8%;
    --plum5: 298, 56.1%, 90.5%;
    --plum6: 296, 51.3%, 85.8%;
    --plum7: 295, 48.2%, 78.9%;
    --plum8: 292, 47.7%, 70.8%;
    --plum9: 292, 45%, 51%;
    --plum10: 292, 50.2%, 46.9%;
    --plum11: 292, 60%, 42.5%;
    --plum12: 291, 66%, 14%;

    --knockout: var(--white);
    --nav: var(--brand-950);
    --background: var(--brand-900);
    --foreground: var(--brand-200);

    --card: var(--brand-950);
    --card-foreground: var(--brand-50);

    --popover: var(--brand-950);
    --popover-foreground: var(--brand-50);

    --primary: var(--brand-50);
    --primary-foreground: var(--brand-900);

    --secondary: var(--brand-800);
    --secondary-foreground: var(--brand-50);

    --muted: var(--brand-800);
    --muted-foreground: var(--brand-400);

    --accent: var(--brand-800);
    --accent-foreground: var(--brand-50);

    --border: var(--brand-200);
    --input: var(--brand-800);
    --ring: var(--brand-300);

    --link-base: var(--plum8);
    --link-active: var(--plum6);
    --link-on: var(--plum4);

    --info: var(--sky-900);
    --info-foreground: var(--sky-100);
    --info-border: var(--sky-400);

    --success: var(--emerald-900);
    --success-foreground: var(--emerald-100);
    --success-border: var(--emerald-400);

    --critical: var(--indigo-900);
    --critical-foreground: var(--indigo-100);
    --critical-border: var(--indigo-400);

    --warning: var(--amber-900);
    --warning-foreground: var(--amber-100);
    --warning-border: var(--amber-400);

    --danger: var(--rose-900);
    --danger-foreground: var(--rose-100);
    --danger-border: var(--rose-400);

    --sh-class: #4dabf7;
    --sh-identifier: #c79bdc;
    --sh-sign: #a1b3c9;
    --sh-property: #34d399;
    --sh-entity: #cd94ff;
    --sh-jsxliterals: hsla(var(--white), 90%);
    --sh-string: #f4a261;
    --sh-keyword: #48cae4;
    --sh-comment: #a7adb2;
  }
}

@layer base {
  * {
    @apply border-border;

    /* help hide some weird effects, apparently all is bad so declare each property explicitly */
    transition: background-color 0.4s ease-in-out;
  }

  html {
    touch-action: manipulation;
    scroll-behavior: smooth;
  }

  body {
    @apply bg-background text-foreground;
    font-feature-settings:
      "rlig" 1,
      "calt" 1;
  }

  .normalize {
    /* general spacing of content */
    & > * {
      @apply mb-[1.25rem] md:mb-[1.375rem] lg:mb-[1.5rem];
    }

    /* lists should feel connected to the preceding content but still show hierarchy
       I'm using a negative margin top to pull the list closer to the preceding content
       which should have the margin bottom applied to it
   */
    & > p + :is(ol, ul) {
      @apply mt-[-0.75rem] md:mt-[-0.875rem] lg:mt-[-1rem];
    }
    & > :is(ol, ul) {
      margin-left: 1.05em;
    }
    & li {
      padding-left: 0.375em;
    }
    /* NOTE: this assumes nested lists will be wrapped in a listitem */
    & :is(ol, ul) li > :is(ol, ul) {
      padding-left: 0.75em;
    }
    & :is(ol, ul) :is(ol, ul) li > :is(ol, ul) {
      padding-left: 1.125em;
    }

    & :is(ol, ul) {
      @apply space-y-[0.5em];
    }

    & ol {
      list-style-type: decimal;
    }
    & ol li ol {
      list-style-type: lower-alpha;
    }
    & ol li ol li ol {
      list-style-type: lower-greek;
    }
    & ul {
      list-style-type: disc;
    }
    & ul li ul {
      list-style-type: circle;
    }
    & ul li ul li ul {
      list-style-type: square;
    }

    strong {
      @apply font-semibold text-knockout;
    }
  }
}

@layer components {
  @keyframes underline-animation {
    0% {
      background-size: 100% 1px;
      background-image: linear-gradient(to right, hsl(var(--link-base)), hsl(var(--link-base)));
    }
    50% {
      background-size: 0% 1px;
      background-image: linear-gradient(to right, hsl(var(--link-active)), hsl(var(--link-active)));
    }
    100% {
      background-size: 100% 1px;
      background-image: linear-gradient(to right, hsl(var(--link-on)), hsl(var(--link-on)));
    }
  }

  .animated-link {
    position: relative;
    padding-bottom: 0px;
    text-decoration: none;
    overflow: hidden;

    background-position: 0 100%;
    background-size: 100% 1px;
    background-repeat: no-repeat;
    background-image: linear-gradient(to right, hsl(var(--link-base)), hsl(var(--link-base)));

    animation-fill-mode: forwards;
    animation-duration: 1500ms !important;
    @media (prefers-reduced-motion) {
      animation-duration: 0ms !important;
    }

    &:hover {
      background-image: linear-gradient(to right, hsl(var(--link-on)), hsl(var(--link-on)));
      animation: underline-animation 1500ms ease-in-out;
      @media (prefers-reduced-motion) {
        animation: underline-animation 0ms ease-in-out;
      }
    }
  }

  .page-container {
    @apply mx-auto w-full max-w-[95%] px-0 sm:max-w-[90%] sm:px-[1.5rem] xl:max-w-[1280px] 2xl:max-w-[1450px];
  }

  .content-container {
    @apply mx-auto w-full max-w-[95%] px-0 sm:max-w-[90%] sm:px-[1.5rem] xl:max-w-[1050px] 2xl:max-w-[1200px];
  }

  .content-container-with-sidebar {
    @apply max-w-full xl:max-w-[800px] 2xl:max-w-[950px];
  }

  .home-link {
    & svg {
      box-shadow: 0px 0px 10px 1px hsl(var(--logo-shadow));
    }
    & .fg {
      transition: transform 0.3s ease-in-out;
    }
    & .border {
      transition: all 1s ease;
    }

    &:is(:hover, :focus, :focus-visible) {
      & .fg {
        transform: translate(-50px, -50px) scale(1.25);
      }
      & .bg {
        fill: var(var(--transparent));
      }
      & .border {
        stroke: hsl(var(--link-active));
      }
    }
  }

  /* based off https://github.com/chakra-ui/chakra-ui/blob/main/packages/components/layout/src/link-box.tsx */
  .link-overlay {
    position: static;
    &:after {
      content: "";
      cursor: inherit;
      transition: transform 0.3s ease;
      @apply absolute left-0 top-0 z-0 block h-full w-full;
    }
  }

  .link-box {
    @apply relative isolate;
    /* elevate elements that are interactable also give special linkbox-elevate class privilege as a catchall */
    & :is(a[href]:not(.link-overlay), button, .linkbox-elevate) {
      @apply relative z-1;
    }
  }

  .card-link {
    transition:
      background-color 0.3s ease,
      border 0.3s ease,
      box-shadow 0.3s ease,
      transform 0.5s linear;
    @apply border border-solid border-link-base;
    &:is(:hover, :focus, :focus-visible) {
      @apply -translate-y-3.5 border-link-active bg-card/40;
      box-shadow:
        hsla(var(--knockout), 20%) 0px 0px 15px,
        hsla(var(--knockout), 15%) 0px 0px 3px 1px;

      &:before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: hsla(var(--link-active), 0.1);
        z-index: -1;
      }
    }
  }

  /* loosely based off https://codepen.io/brucebrotherton/pen/GRxwQar */
  blockquote[data-variant="quote"] {
    & {
      @apply my-12 text-center;
    }

    &:before,
    &:after {
      position: absolute;
      font-size: 5rem;
      color: hsl(var(--muted-foreground));
    }
    &:before {
      top: -1.5rem;
      left: 0rem;
      content: open-quote;
    }
    &:after {
      bottom: -2.875rem;
      right: 1.25rem;
      content: close-quote;
    }
  }

  figcaption {
    @apply mt-4 text-balance text-center text-muted-foreground;
  }

  .anchor-link {
    /* since color of url in content can't easily be adjusted, use the mask trick instead https://stackoverflow.com/a/66093928/7413060 */
    &:after {
      content: "";
      display: inline-block;
      margin: 0 0.125em;
      width: 1em;
      height: 1em;
      /* these are kind of magic numbers based off a few trial and errors on one machine */
      transform: scale(0.85) translateY(0.15em);
      mask-image: var(--icons-anchor);
      mask-size: cover;
      background-color: transparent;
      transition: background-color 0.4s ease-in-out;
    }
    &:hover:after {
      background-color: currentColor;
    }
  }
}

@layer utilities {
  .hide-mobile {
    @apply isMobile:hidden !important;
  }
  .hide-desktop {
    @apply isDesktop:hidden !important;
  }

  .text-balance {
    text-wrap: balance;
  }

  .animation-play-state-paused {
    animation-play-state: paused;
  }

  .animation-play-state-running {
    animation-play-state: running;
  }

  /* credits to xetera for the initial idea */
  /* resource: https://bennettfeely.com/clippy/ */
  .clip-list-image-left {
    clip-path: polygon(3% 0, 100% 0, 100% 100%, 20% 100%);
  }
  .clip-list-image-right {
    clip-path: polygon(0 0, 97% 0, 80% 100%, 0 100%);
  }

  /* radix ui */
  .animated-collapsible {
    @apply overflow-hidden data-[state=closed]:animate-collapsible-close data-[state=open]:animate-collapsible-open;
  }

  .animated-arrow {
    @apply transition-transform duration-300 ease-arrow-ease group-data-[state=closed]:-rotate-90;
  }
}
